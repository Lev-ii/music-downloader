<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Music Downloader by Levi</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">


</head>
<body>
  <header>
    <h1>ğŸ§ Music Downloader</h1>
    <p>TÃ©lÃ©charge tes sons SANS PUB !</p>
  </header>

  <main>
    <section class="search-box">
      <label for="artist">Artiste</label>
      <input type="text" id="artist" placeholder="Nom de l'Artiste" />

      <label for="title">Titre</label>
      <input type="text" id="title" placeholder="Titre de la Chanson" />

      <button id="download-btn">Rechercher & TÃ©lÃ©charger</button>
      <div id="spinner" style="display:none;">
        <div class="spinner-circle"></div>
        <p style="margin-left: 10px;">TÃ©lÃ©chargement en cours...</p>
      </div>

    </section>

    <section class="history">
      <h2>ğŸ“‚ TÃ©lÃ©chargements rÃ©cents</h2>
      <ul id="download-list">
      </ul>
    </section>
  </main>
  <div id="success-banner" class="hidden">ğŸ‰ TÃ©lÃ©chargement rÃ©ussi !</div>


  <footer>
    <p>âš™ï¸ ParamÃ¨tres | ğŸ” Mentions lÃ©gales</p>
    <p>Â© 2025 Levi Dev</p>
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</body>
<script>
const downloadBtn = document.getElementById("download-btn");
const spinner = document.getElementById("spinner");
const downloadList = document.getElementById("download-list");
const successBanner = document.getElementById("success-banner");

downloadBtn.addEventListener("click", () => {
  const artist = document.getElementById("artist").value;
  const title = document.getElementById("title").value;

  spinner.style.display = "block"; // Affiche le spinner

  fetch("/download", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ artist, title })
  })
  .then(response => response.json())
  .then(data => {
    spinner.style.display = "none"; // Cache le spinner

    // ğŸ‰ Confettis !
    confetti({
      particleCount: 150,
      spread: 70,
      origin: { y: 0.6 }
    });

    // Ajouter Ã  la liste
    const li = document.createElement("li");
    li.textContent = `âœ… ${artist} - ${title}`;
    li.classList.add("download-item");
    downloadList.appendChild(li);

    // Jouer le son
    const successSound = new Audio("/static/success.mp3");
    successSound.play();

    // Afficher le toast/banner au lieu de alert
    successBanner.textContent = `ğŸµ ${artist} - ${title} tÃ©lÃ©chargÃ©e !`;
    successBanner.classList.remove("hidden");

    // DisparaÃ®t aprÃ¨s 3 secondes
    setTimeout(() => {
      successBanner.classList.add("hidden");
    }, 3000);

    // Badge si beaucoup de tÃ©lÃ©chargements
    let count = parseInt(localStorage.getItem("downloadCount") || "0");
    count++;
    localStorage.setItem("downloadCount", count);

    if (count >= 5 && !document.querySelector(".badge")) {
      const badge = document.createElement("div");
      badge.textContent = "ğŸ… Top TÃ©lÃ©chargeur !";

      badge.className = "badge";
      document.body.appendChild(badge);
    }

  })
  .catch(error => {
    spinner.style.display = "none";
    console.error("Erreur :", error);
    // Afficher un toast d'erreur
    successBanner.textContent = "âŒ Erreur lors du tÃ©lÃ©chargement";
    successBanner.classList.remove("hidden");
    setTimeout(() => successBanner.classList.add("hidden"), 3000);
  });
});
</script>



</html>
